4장 테스트 구축하기

- 리팩터링에는 견고한 테스트 스위트가 뒷받침돼야한다.

  4.1 자가 테스트 코드의 가치

- 실제 업무에서 코드 작성시간 보다는 대부분은 디버깅에 쏟는다.
- 모든 테스트를 자동화하고 그 결과까지 스스로 검사하게 만들자
- 테스트 스위트는 버그를 찾는 데 걸리는 시간을 대폭 줄여준다.
- 테스트를 작성하기 가장 좋은 시점은 개발을 시작하기 전이다.
  → 테스트를 고민하다보면 기능개발에 무엇이 필요한지 고민하게 된다.
  → 구현보다 인터페이스에 집중하게 된다는 장점
  → 코딩이 완료되는 시점을 정확하게 판단할 수 있다.

  4.2 테스트할 샘플 코드

  4.3 첫 번째 테스트

- `실패해야 할 상황에서는 반드시 실패하게 만들자.`
- 작성중인 코드는 최소 몇 분 간격으로 테스트하고, 적어도 하루에 한 번은 전체 테스트를 돌려보자.
- GUI든 콘솔이든 결국 모든 테스트가 통과했다는 사실을 빨리 알 수 있게하는게 핵심

  4.4 테스트 추가하기

- 테스트는 위험요인을 중심을 작성해야 한다.
- 목적은 어디까지나 현재 혹은 향후에 발생하는 버그를 찾는 것
- 완벽하게 만드느라 테스트를 수행하지 못하느니, `불완전한 테스트라도 작성해 실행하는 게 낫다.`
- 테스트끼리 상호작용하게 공유 픽스처를 생성하면 테스트 실행 순서에 따라 결과가 달라지는 문제가 발생한다. → 모든 테스트를 독립적으로 구성하자.

  4.5 픽스쳐 수정하기

- `it 구문 하나당 검증 하나가 좋다`. 앞 검증을 통과하지 못하면 실패 원인을 파악하는 데 유용한 정보를 놓치기 쉽다.

  4.6 경계 조건 검사하기

- 문제가 생길 가능성이 있는 경계 조건을 생각해보고 집중적으로 테스트하자
- 의식적으로 프로그램을 망가뜨리는 방법을 모색하기
  → 특이상황에 대해 어떻게 처리하는게 좋을지 생각해볼 수 있다.
- 어차피 모든 버그를 잡아낼 수 는 없다고 생각하여 테스트를 작성하지 않는다면 대다수의 버그를 잡을 수 있는 기회를 날리는 셈
- 아무리 테스트해도 버그 없는 완벽한 프로그램은 만들 수 없지만 `테스트가 프로그래밍 속도를 높여준다.`
- 테스트에도 수확 체감 법칙이 적용된다. → 위험한 부분에 집중하기
- 모든 버그를 걸러주지 못할지라도, `안심하고 리팩터링할 수 있는 보호막은 되어준다.`

→ 테스트에 적응이 되지않는 시절엔 테스트를 만들생각을 못하고 수기로 하나하나 예상한 결과가 맞는지 확인했던 적도 있다.. 허허

4.7 끝나지 않은 여정

- 버그 리포트를 받으면 가장 먼저 그 버그를 드러내는 단위 테스트부터 작성하자
- `테스트 커버리지는 테스트하지 않은 영역을 찾는 데만 도움될 뿐 테스트 품질과는 상관없다`
- 테스트가 충분한지의 평가는 주관적이지만, `자가 테스트 코드의 목적은 믿음(누군가가 결함을 심으면 테스트가 발견할 수 있다는)을 갖게 해주는 것`
- 테스트 때문에 개발속도가 느려진다고 생각되면 테스트를 과하게 작성한건 아닌지 의심해보자 (보통 많은 경우보다 너무 적은 경우가 훨씬 훨씬 많다.)
